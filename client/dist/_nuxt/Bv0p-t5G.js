import{L as x,M as C,r as f,b as n,g as F,j as P,k as S,w as d,N as L,o as U,d as b,O as q,P as y,l as m,t as B}from"./E0JwD-zS.js";import{a as M,V as T,b as D}from"./3ultSFnu.js";import{u as E,m as N,V as k}from"./CU8bTfFG.js";import{c as $,f as h,m as j,V as R,a as O}from"./DCxWHRiv.js";import"./CH1yUQZ9.js";const z=C({...N(),...j()},"VForm"),A=x()({name:"VForm",props:z(),emits:{"update:modelValue":p=>!0,submit:p=>!0},setup(p,c){let{slots:i,emit:V}=c;const l=$(p),o=f();function v(s){s.preventDefault(),l.reset()}function g(s){const u=s,r=l.validate();u.then=r.then.bind(r),u.catch=r.catch.bind(r),u.finally=r.finally.bind(r),V("submit",u),u.defaultPrevented||r.then(w=>{var e;let{valid:t}=w;t&&((e=o.value)==null||e.submit())}),u.preventDefault()}return E(()=>{var s;return n("form",{ref:o,class:["v-form",p.class],style:p.style,novalidate:!0,onReset:v,onSubmit:g},[(s=i.default)==null?void 0:s.call(i,l)])}),h(l,o)}}),Q=F({__name:"index",setup(p){const c=f(""),i=f(""),V=f(!1),l=f(!1),o=f(!1),v=f(""),g=L(),s=P(),u=[t=>!!t||"Email is required",t=>/.+@.+\..+/.test(t)||"Email must be valid"],r=[t=>!!t||"Password is required"],w=async()=>{var t,e;l.value=!0;try{const a=await $fetch(`${s.apiBaseURL}/api/auth/login`,{method:"POST",credentials:"include",body:{email:c.value,password:i.value}});s.setUser(a.user),await g.push("/")}catch(a){console.log(a),o.value=!0,v.value=((e=(t=a.response)==null?void 0:t._data)==null?void 0:e.message)||"Login failed"}finally{l.value=!1}};return(t,e)=>(U(),S(M,{class:"d-flex justify-center align-center fill-height"},{default:d(()=>[n(T,{width:"400",class:"pa-6 elevation-8"},{default:d(()=>[n(D,{class:"text-h5 text-center mb-4"},{default:d(()=>e[5]||(e[5]=[b("Login")])),_:1}),n(A,{modelValue:m(V),"onUpdate:modelValue":e[2]||(e[2]=a=>y(V)?V.value=a:null),onSubmit:q(w,["prevent"])},{default:d(()=>[n(R,{color:"primary",variant:"outlined",density:"compact",class:"mb-4",modelValue:m(c),"onUpdate:modelValue":e[0]||(e[0]=a=>y(c)?c.value=a:null),modelModifiers:{trim:!0},label:"Email","prepend-inner-icon":"mdi-email",rules:u,type:"email",required:""},null,8,["modelValue"]),n(R,{color:"primary",variant:"outlined",density:"compact",modelValue:m(i),"onUpdate:modelValue":e[1]||(e[1]=a=>y(i)?i.value=a:null),modelModifiers:{trim:!0},label:"Password","prepend-inner-icon":"mdi-lock",rules:r,type:"password",required:""},null,8,["modelValue"]),n(k,{type:"submit",color:"primary",class:"mt-4",disabled:!m(V)||m(l),block:"",loading:m(l)},{default:d(()=>e[6]||(e[6]=[b(" Login ")])),_:1},8,["disabled","loading"])]),_:1},8,["modelValue"]),n(O,{modelValue:m(o),"onUpdate:modelValue":e[4]||(e[4]=a=>y(o)?o.value=a:null),color:"primary",timeout:"5000"},{actions:d(()=>[n(k,{color:"surface",variant:"outlined",onClick:e[3]||(e[3]=a=>o.value=!1)},{default:d(()=>e[7]||(e[7]=[b(" Close ")])),_:1})]),default:d(()=>[b(B(m(v))+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{Q as default};
